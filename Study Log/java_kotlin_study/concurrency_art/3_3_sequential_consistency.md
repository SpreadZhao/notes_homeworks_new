---
title: 3.3 é¡ºåºä¸€è‡´æ€§
chapter: "3"
order: "6"
---
## 3.3 é¡ºåºä¸€è‡´æ€§

ç°åœ¨å‡è®¾ï¼Œæœ‰ä¸ªå˜é‡xï¼Œåˆå§‹å€¼ä¸º0ã€‚ç„¶åæœ‰100ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æ‰€åšçš„äº‹æƒ…å°±æ˜¯å°†è¿™ä¸ªå˜é‡+1ã€‚çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†æ˜¯æ¯ä¸ªçº¿ç¨‹éœ€è¦åšçš„äº‹æƒ…å´ä¸å°‘ï¼š

* è¯»å‡ºåŸæ¥çš„xå€¼ï¼›
* åœ¨æ­¤åŸºç¡€ä¸Š+1ï¼›
* æŠŠæ–°å€¼å†™å›å»ã€‚

æ˜¾ç„¶ï¼Œå¦‚æœä¸ƒæ‰‹å…«è„šåœ°è¿›è¡Œè¯»å–ï¼Œæœ€åçš„ç»“æœè‚¯å®šæ˜¯å¾ˆè‰¹è›‹çš„ã€‚å°±æ‹¿ä¸¤ä¸ªçº¿ç¨‹ä¸¾ä¾‹å­ï¼Œå®ƒä¿©åŒæ—¶è¯»äº†xï¼Œå‘ç°éƒ½æ˜¯0ï¼Œæ‰€ä»¥è¿™ä¿©çº¿ç¨‹éƒ½æŠŠxæ›´æ–°æˆäº†1ï¼Œæœ€åè¿˜æ˜¯1ã€‚ä½†æ˜¯æŒ‰ç…§æˆ‘ä»¬çš„æœŸæœ›ï¼Œå®ƒåº”è¯¥å˜æˆ2æ‰å¯¹ã€‚

### 3.3.1 æ•°æ®ç«äº‰ä¸é¡ºåºä¸€è‡´æ€§

å¦‚æœï¼Œåˆšæ‰é‚£ä¸ªä¾‹å­ï¼Œå¤šå°‘ä¸ªçº¿ç¨‹æ“ä½œä¹‹åï¼Œxå°±å¢åŠ å¤šå°‘ï¼Œå°±æ„å‘³ç€**å³ä½¿æ˜¯å¤šçº¿ç¨‹å¹¶å‘çš„æ‰§è¡ŒçŠ¶æ€ä¸‹ï¼Œå’Œé¡ºåºæ‰§è¡Œçš„ç»“æœä¹Ÿä¸€æ ·**ã€‚è¿™æ ·çš„æ€§è´¨å°±å«åš**é¡ºåºä¸€è‡´æ€§**ã€‚

å®é™…ä¸Šï¼Œé¡ºåºä¸€è‡´æ€§çš„èµ·æºæ˜¯**é¡ºåºä¸€è‡´æ€§å†…å­˜æ¨¡å‹**ã€‚å¤ªé«˜æ·±ï¼Œå…ˆä¸é¸Ÿå®ƒã€‚

ç„¶åï¼Œä½ ä½œä¸ºä¸€ä¸ªå¤šçº¿ç¨‹å¹¶å‘çš„æ¨¡å‹ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½ç­‰ç€æŠ¢æ•°æ®ï¼Œåˆæ€ä¹ˆå¯èƒ½å¹³ç™½æ— æ•…å°±èƒ½å…·æœ‰é¡ºåºä¸€è‡´æ€§å‘¢ï¼Ÿå› æ­¤ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹ä¹‹é—´å¿…ç„¶å‘ç”Ÿ**æ•°æ®ç«äº‰**ã€‚Javaå†…å­˜æ¨¡å‹è§„èŒƒå¯¹æ•°æ®ç«äº‰çš„å®šä¹‰å¦‚ä¸‹ï¼š

* åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å†™ä¸€ä¸ªå˜é‡ï¼›
* åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­è¯»è¿™ä¸ªå˜é‡ï¼›
* è€Œä¸”å†™å’Œè¯»æ²¡æœ‰é€šè¿‡åŒæ­¥æ“ä½œæ¥æ’åºã€‚

- [ ] #TODO tasktodo1715333769430 ä¹¦ä¸Šè¿™ä¹ˆå†™çš„ï¼Œä½†æ˜¯Javaå†…å­˜æ¨¡å‹è§„èŒƒé‡ŒçœŸæœ‰è¿™ä¸ªå—ï¼Ÿæ‰¾æ‰¾ã€‚å¦å¤–å…¶å®ƒçš„è§„èŒƒæ˜¯ä¸æ˜¯ä¹Ÿéœ€è¦çœ‹çœ‹ï¼Ÿä¸€äº›é‡è¦çš„ï¼Ÿ ğŸ”¼ â• 2024-05-10 ^b68769

æ‰€ä»¥ï¼Œæˆ‘ä»¬æƒ³æ¶ˆé™¤æ•°æ®ç«äº‰ï¼Œå°±è¦åŒæ­¥ã€‚è€Œ**åŒæ­¥çš„è¿‡ç¨‹ï¼Œå°±æ˜¯å¯¹syncronized, volatile, finalçš„æ­£ç¡®ä½¿ç”¨**ã€‚

### 3.3.2 é¡ºåºä¸€è‡´æ€§å†…å­˜æ¨¡å‹

å¥½å§ï¼Œè¿˜æ˜¯å¾—æã€‚**å®é™…ä¸ŠJMMä¸æ˜¯è¿™æ ·çš„å†…å­˜æ¨¡å‹**ã€‚å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹Aå’ŒBï¼Œå®ƒä»¬çš„æ“ä½œåˆ†åˆ«æ˜¯ï¼š

-  Açº¿ç¨‹ï¼š

```java
a++ // A1
b++ // A2
c++ // A3
```

---

-  Bçº¿ç¨‹ï¼š

```java
a-- // B1
b-- // B2
c-- // B3
```

é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨è®©è¿™ä¸¤ä¸ªçº¿ç¨‹è·‘èµ·æ¥ï¼Œä¸åšä»»ä½•é™åˆ¶ï¼Œé‚£ä¹ˆæ˜¾ç„¶ï¼Œå•¥éƒ½æœ‰å¯èƒ½ã€‚ç”šè‡³ï¼Œå› ä¸ºå¯¹äºå•ä¸ªçº¿ç¨‹æ¥è¯´ï¼Œè¿™äº›è¯­å¥ä¹‹é—´ä¹Ÿä¸å­˜åœ¨æ•°æ®ä¾èµ–ï¼Œæ‰€ä»¥å¯ä»¥æƒ³æ€ä¹ˆé‡æ’åºå°±æ€ä¹ˆé‡æ’åºã€‚

å› æ­¤ï¼Œæœ€åçš„æ‰§è¡Œé¡ºåºå¯èƒ½æ˜¯

$$
A_2 \rightarrow B_1 \rightarrow A_3 \rightarrow B_3 \rightarrow A_1 \rightarrow B_2
$$

çœ‹èµ·æ¥ä¹±ä¸ƒå…«ç³Ÿå¯¹å§ã€‚ä¹±å°±å¯¹äº†ï¼è¿™å°±æ˜¯ä¸åŠ çº¦æŸçš„åæœã€‚è°çŸ¥é“CPUä¸ºäº†æé«˜æ€§èƒ½ä¼šç»™æˆ‘ä»¬çš„ä»£ç ææˆä»€ä¹ˆæ ·å­å‘¢ã€‚ã€‚ã€‚

å¦ä¸€ä¸ªæƒ…å†µæ˜¯ï¼Œå‡è®¾æˆ‘ä»¬çš„B2æ“ä½œä¼šç”¨åˆ°A1æ“ä½œçš„ç»“æœï¼Œä¹Ÿå°±æ˜¯B2æ“ä½œå¿…é¡»åœ¨A1ä¹‹åæ‰èƒ½æ‰§è¡Œã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ç§å¹¶å‘çŠ¶æ€ä¸‹ï¼Œå¥½åƒæ ¹æœ¬ä¸è¡Œå‘€ï¼ä½ éƒ½é‡æ’åºäº†ï¼Œè€Œä¸”ï¼Œ**B2ä¹Ÿæ²¡æœ‰ä»»ä½•æ‰‹æ®µèƒ½å¤ŸçŸ¥é“A1æ“ä½œç»“æŸäº†**ã€‚å› ä¸ºç°åœ¨è¿˜æ²¡æœ‰æ­å»ºé€šä¿¡çš„åª’ä»‹ï¼ŒA1ç»“æŸä¹‹åä¹Ÿæ²¡å‘ä»€ä¹ˆå¹¿æ’­ä¹‹ç±»çš„é€šçŸ¥ç»™å¤§å®¶ã€‚

å› æ­¤ï¼Œé¡ºåºä¸€è‡´æ€§å†…å­˜æ¨¡å‹è¯ç”Ÿäº†ï¼å®ƒå°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜çš„å†…å­˜æ¨¡å‹ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸‹ï¼Œå¹¶å‘çš„æ‰§è¡Œæ˜¯æœ‰é™åˆ¶çš„ï¼š

1. ä¸€ä¸ªçº¿ç¨‹ä¸­çš„æ‰€æœ‰æ“ä½œå¿…é¡»æŒ‰ç…§**ç¨‹åºçš„é¡ºåº**æ¥æ‰§è¡Œã€‚
2. ï¼ˆä¸ç®¡ç¨‹åºæ˜¯å¦åŒæ­¥ï¼‰æ‰€æœ‰çº¿ç¨‹éƒ½åªèƒ½çœ‹åˆ°ä¸€ä¸ªå•ä¸€çš„æ“ä½œæ‰§è¡Œé¡ºåºã€‚åœ¨é¡ºåºä¸€è‡´æ€§å†…å­˜æ¨¡å‹ä¸­ï¼Œ**æ¯ä¸ªæ“ä½œéƒ½å¿…é¡»åŸå­æ‰§è¡Œä¸”ç«‹åˆ»==å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§==**ã€‚

ç¬¬ä¸€ç‚¹å°±æ˜¯è¯´ï¼Œä½ ~~**å•çº¿ç¨‹é‡Œå°±åˆ«é‡æ’åºå•¦**~~ï¼›ç¬¬äºŒç‚¹åœ¨è¯´ï¼Œä»»ä½•çº¿ç¨‹çš„ä»»ä½•æ“ä½œæ‰§è¡Œå®Œä¹‹åï¼Œéƒ½å¿…é¡»è®©æ‰€æœ‰çº¿ç¨‹å¯è§ã€‚ä¸¾ä¸ªä¾‹å­ï¼š

> [!comment]- å•çº¿ç¨‹é‡Œå°±åˆ«é‡æ’åºå•¦
> è¿™é‡Œè¦çº æ­£ä¸€ä¸‹ï¼Œé€šè¿‡ä¸‹é¢çš„å›¾ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼Œé¡ºåºä¸€è‡´æ€§æ¨¡å‹å¹¶ä¸æ˜¯è®©å•çº¿ç¨‹ä¸å…è®¸é‡æ’åºï¼Œè€Œæ˜¯ä½ æŠŠæ‰€æœ‰çº¿ç¨‹çš„æŒ‡ä»¤æ‹å‡ºæ¥ï¼Œæ‹åˆ°ä¸€å—å„¿å»ä¹‹åï¼Œç»è¿‡é‡æ’åºä¹‹åï¼Œè¿™äº›æŒ‡ä»¤çš„æ—¶é—´é¡ºåºè¦å’Œå•çº¿ç¨‹ä¸­çš„æ—¶é—´é¡ºåºä¸€æ ·ã€‚å…·ä½“çœ‹ä¸‹é¢çš„å›¾å°±çŸ¥é“äº†ã€‚
> 
> #date 2024-05-10 è‰ï¼Œæ„Ÿè§‰ç¡®å®æ˜¯å•çº¿ç¨‹é‡Œä¸èƒ½é‡æ’åºã€‚ä¸‹é¢ç¬¬äºŒå¼ å›¾é‡Œï¼Œå•ç‹¬æ‹†Aå’ŒBçº¿ç¨‹ï¼Œä¸ä¹Ÿæ˜¯æ²¡æœ‰é‡æ’åºçš„çŠ¶æ€å—ï¼Ÿå°±æ˜¯a1 a2 a3è¿™æ ·ï¼Œæ²¡æœ‰æ‰“ä¹±ï¼Œå¯¹äºBä¹Ÿæ˜¯ä¸€æ ·ã€‚

![[Study Log/java_kotlin_study/concurrency_art/resources/Pasted image 20231109232551.png]]

è¿™æ˜¯**æˆ‘ä»¬é‡‡ç”¨äº†åŒæ­¥ä¹‹å**çš„ç»“æœï¼Œè®©Açº¿ç¨‹æ‰€æœ‰æ“ä½œéƒ½æ‰§è¡Œå®Œæ‰è®©Bå¼€å§‹ã€‚è¿™ä¸ªæ‰§è¡Œé¡ºåºï¼ŒABçº¿ç¨‹éƒ½æ˜¯èƒ½çœ‹åˆ°çš„ã€‚

å¦å¤–ï¼Œåœ¨é¡ºåºä¸€è‡´æ€§å†…å­˜ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸åŒæ­¥ï¼Œè™½ç„¶ä¸åŒæ­¥ï¼Œä½†æ˜¯ä¹Ÿè¦ç¬¦åˆä¸Šé¢çš„ä¸¤ç‚¹è¦æ±‚ã€‚æ¯”å¦‚ï¼š

![[Study Log/java_kotlin_study/concurrency_art/resources/Pasted image 20231109232729.png]]

çœ‹åˆ°æ²¡ï¼Œå•ç‹¬æ‹†å‡ºæ¥ï¼ŒA1å°±æ˜¯åœ¨A2å‰é¢ï¼ŒA2å°±æ˜¯åœ¨A3å‰é¢ã€‚Bä¹Ÿæ˜¯åŒç†ã€‚ä¹Ÿå°±æ˜¯ä¸å…è®¸ä½ ç»™å•çº¿ç¨‹é‡Œé‡æ’åºï¼›åŒæ—¶ï¼Œå³ä½¿è¿™ä¸ªé¡ºåºçœ‹èµ·æ¥æ¯”è¾ƒä¹±ï¼Œ**ä½†ä¹Ÿæ˜¯æœ‰åºçš„ï¼Œä¸”ABçº¿ç¨‹éƒ½èƒ½çœ‹åˆ°**ã€‚

ä»¥ä¸Šè¯´çš„è¿™äº›ï¼ŒJavaç»Ÿç»Ÿæ²¡æœ‰ã€‚ã€‚ã€‚ä¸ºå•¥æ²¡æœ‰è¿˜è¦è¯´å‘¢ï¼Ÿè¿™å…¶å®ç®—æ˜¯ä¸€ä¸ªæ ‡å‡†ã€‚å¦‚æœæˆ‘ä»¬è‡ªå·±å†™çš„å¹¶å‘æ§åˆ¶èƒ½è¾¾åˆ°é¡ºåºä¸€è‡´æ€§å†…å­˜çš„æ°´å¹³ï¼Œé‚£ä¹ˆå°±ä»£è¡¨è¿™ä¸ªå¹¶å‘å†™çš„æ˜¯OKçš„ã€‚

### 3.3.3 åŒæ­¥ç¨‹åºçš„é¡ºåºä¸€è‡´æ€§æ•ˆæœ

æ”¹é€ ä¸€ä¸‹ä¹‹å‰é‚£ä¸ªè¯»å’Œå†™çš„ä»£ç ï¼š

```java
class ReorderExample {
	int a = 0;
	boolean flag = false;

	public void writer() {
		a = 1;  // 1
		flag = true;  // 2
	}

	public void reader() {
		if (flag) {  // 3
			int i = a * a;  // 4
			... ...
		}
	}
}
```

æ€ä¹ˆæ”¹ï¼Œèƒ½åˆç†ï¼Ÿé¦–å…ˆï¼Œè¿™ç©æ„å„¿è¿˜æ²¡è·‘èµ·æ¥å‘¢ï¼Œæˆ‘å…ˆå†™ä¸ªèƒ½è·‘çš„ã€‚ã€‚ã€‚

```kotlin
class ReorderExample {
  var a = 1
  var flag = false
  fun writer() {
    a = 3
    Thread.sleep(1) // ç¨åŠ å¹²æ‰°ï¼Œå°±è¯»ä¸äº†äº†ã€‚
    flag = true
  }
  fun reader() {
    if (flag) {
      val i = a * a
      println("i: $i")
    } else {
      println("I can't read it!")
    }
  }
  companion object {
    fun test() {
      val example = ReorderExample()
      thread { example.writer() }
      thread { example.reader() }
    }
  }
}
```

å¦‚æœä½ çœŸå†™ä¸Šå»ï¼Œè¿˜çœŸèƒ½è¯»åˆ°å€¼ã€‚ä½†æ˜¯è¿™æ˜¯å› ä¸ºwriter()æ‰§è¡Œå¾—å¤ªå¿«äº†ã€‚åªè¦ä½ ç¨å¾®åŠ ä¸ªä¼‘æ¯çš„æ“ä½œï¼Œå°±è¯»ä¸åˆ°äº†ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿå¾ˆç®€å•ï¼åŠ ä¸¤ä¸ªsynchronizedå°±æˆäº†ï¼

```kotlin
class ReorderExample {
  var a = 1
  var flag = false
  @Synchronized
  fun writer() {
    a = 3
    Thread.sleep(10000)
    flag = true
  }
  @Synchronized
  fun reader() {
    if (flag) {
      val i = a * a
      println("i: $i")
    } else {
      println("I can't read it!")
    }
  }
  companion object {
    fun test() {
      val example = ReorderExample()
      thread { example.writer() } // Thread A
      thread { example.reader() } // Thread B
    }
  }
}
```

è¿™æ ·ï¼Œä½ æƒ³æ€ä¹ˆä¼‘æ¯å°±æ€ä¹ˆä¼‘æ¯ã€‚åªè¦Açº¿ç¨‹å…ˆè·å¾—é”ï¼Œä½ Bå°±å¾—åœ¨é‚£å„¿ç­‰ç€ã€‚è¿˜è®°å¾—ä¹‹å‰è¯´çš„å—ï¼š[[Study Log/java_kotlin_study/concurrency_art/2_concurrency_internal#2.2 syncronized|2_concurrency_internal]]ï¼Ÿsyncronizedä¿®é¥°æ–¹æ³•çš„æ—¶å€™ï¼Œé”æ˜¯å½“å‰å®ä¾‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œé”å°±æ˜¯`example`è¿™ä¸ªå®ä¾‹ã€‚

ä¸‹é¢ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼š

- [?] *ä½ åŠ äº†è¿™ä¸¤ä¸ªsyncronizedä¹‹åï¼ŒçœŸçš„å°±å’Œå†…å­˜ä¸€è‡´æ€§æ¨¡å‹ä¸€æ ·äº†å—ï¼Ÿ*

ç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚syncronizedåªæ˜¯ä¸€æŠŠé”ï¼Œå®ƒæ²¡åŠæ³•æ§åˆ¶æŒ‡ä»¤çœŸæ­£çš„æ‰§è¡Œé¡ºåºã€‚æ‰€ä»¥ï¼Œèƒ½é‡æ’åºçš„åœ°æ–¹ã€‚å®ƒè¿˜æ˜¯ä¼šé‡æ’åºçš„ã€‚æ¯•ç«Ÿä¸ºäº†æ€§èƒ½å˜›ï¼ä½†æ˜¯ï¼Œæˆ‘ä»¬è¦å¥½å¥½æƒ³ä¸€æƒ³ï¼š*å®ƒåœ¨å“ªé‡Œé‡æ’åºçš„å‘¢*ï¼Ÿ

ç­”æ¡ˆä¹Ÿå¾ˆç®€å•ï¼šåªè¦ä¸æ˜¯è¢«syncronizedé™åˆ¶çš„åœ°æ–¹ï¼Œéƒ½ä¼šé‡æ’åºï¼š

![[Study Log/java_kotlin_study/concurrency_art/resources/Pasted image 20231119140506.png]]

ä¸Šå›¾æ˜¯æˆ‘ä»¬çš„Java/Kotlinå¹¶å‘ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸çœŸæ­£çš„é¡ºåºä¸€è‡´æ€§æ¨¡å‹ä¸­æ‰§è¡Œçš„æƒ…å†µçš„å¯¹æ¯”ã€‚å¯ä»¥å‘ç°ï¼Œåœ¨syncronizedä»£ç å—é‡Œé¢çš„è¯­å¥å…¶å®æ˜¯å¯ä»¥é‡æ’åºçš„ï¼Œä½†æ˜¯å®ƒ**ä¸å…è®¸ä¸´ç•ŒåŒºå†…çš„ä»£ç é€ƒé€¸åˆ°syncronizedçš„å¤–é¢**ã€‚è™½ç„¶Açº¿ç¨‹åšäº†é‡æ’åºï¼Œä½†æ˜¯Bä¹Ÿæ— æ³•è§‚å¯Ÿåˆ°Açš„é‡æ’åºï¼Œå› ä¸ºsyncronizedæœ¬èº«å°±æ˜¯äº’æ–¥çš„ã€‚æ‰€ä»¥ï¼Œè¿™ç§æ–¹æ³•æ—¢æé«˜äº†æ‰§è¡Œæ•ˆç‡ï¼Œåˆæ²¡æœ‰æ”¹å˜ç¨‹åºçš„æ‰§è¡Œç»“æœã€‚ ^0578f5

- [ ] #TODO è¿™é‡Œæˆ‘çªç„¶æƒ³åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šåœ¨Lockä¸­ï¼Œæ¯”å¦‚ä½ è°ƒç”¨äº†lock.lock()ï¼Œé‚£ä¹ˆåé¢çš„ä»£ç å°±æ˜¯è·å¾—äº†é”ä¹‹åæ‰èƒ½æ‰§è¡Œçš„äº†ã€‚é‚£ä¹ˆï¼Œjavaæ˜¯æ€ä¹ˆä¿è¯locké‡Œé¢çš„æŒ‡ä»¤ä¸ä¼šè¢«é‡æ’åºåˆ°lockå¤–é¢çš„å‘¢ï¼Ÿè¨€å¤–ä¹‹æ„ï¼ŒJavaçš„lockï¼Œæˆ–è€…å…¶åº•å±‚çš„AQSé‡Œé¢çš„é‚£ä¸ªvolatileï¼Œå°±èƒ½ä¿è¯å—ï¼Ÿï¼Ÿï¼Ÿï¼Ÿã€‚ã€‚ã€‚ã€‚å§æ§½ï¼Œå¥½åƒè¿˜çœŸèƒ½ã€‚æ ¹æ®åé¢çš„volatileçš„å®šä¹‰ï¼Œå°±èƒ½ä¿è¯é‡æ’åºäº†ã€‚è¿™ä¸ªé—®é¢˜éœ€è¦æ€»ç»“ä¸€ä¸‹å¥½å¥½è¯´ä¸€è¯´ã€‚ â• 2024-03-10 ğŸ”¼ 

### 3.3.4 JMM vs å†…å­˜ä¸€è‡´æ€§æ¨¡å‹

| å†…å­˜ä¸€è‡´æ€§æ¨¡å‹                       | JMM                              |
| ------------------------------------ | -------------------------------- |
| å•çº¿ç¨‹å†…é¡ºåºæ‰§è¡Œ                     | ä¸ä¿è¯å•çº¿ç¨‹å†…é¡ºåºæ‰§è¡Œï¼ˆé‡æ’åºï¼‰ |
| æ‰€æœ‰çº¿ç¨‹çœ‹åˆ°çš„æ‰§è¡Œé¡ºåºä¸€è‡´           | ä¸ä¿è¯æ‰€æœ‰çº¿ç¨‹çœ‹åˆ°çš„æ‰§è¡Œé¡ºåºä¸€è‡´ |
| ä¿è¯å¯¹æ‰€æœ‰å†…å­˜çš„è¯»å†™æ“ä½œéƒ½å…·æœ‰åŸå­æ€§ | ä¸ä¿è¯å¯¹64ä½çš„longå’Œdoubleçš„å†™æ“ä½œå…·æœ‰åŸå­æ€§                                 |

> è¿™é‡Œçš„ç¬¬ä¸‰æ¡å¯ä»¥å‚è€ƒåŸæ–‡

- [ ] #TODO å’Œ[[#^b68769|tasktodo1715333769430]]ä¸€æ ·ï¼ŒåŸæ–‡åœ¨JMMé‡Œï¼Œæ‰¾åˆ°å®ƒï¼ ğŸ”¼ â• 2024-05-10

---

```dataviewjs
const pages = dv.pages('"Study Log/java_kotlin_study/concurrency_art"')
let nextChapterHead = undefined
let res = undefined
const current = dv.current()
for (let page of pages) {
	if (page.chapter_root == true && page.order == Number(current.chapter) + 1) {
		console.log("found next head: " + page.name)
		nextChapterHead = page
		continue
	}
	if (page.chapter == undefined || page.chapter != current.chapter) {
		console.log("not current chapter: " + page.file.name)
		continue
	}
	if (page.order == Number(current.order) + 1) {
		res = page
	}
}
console.log("res: " + res)
console.log("next: " + nextChapterHead)
if (res == undefined) {
	res = nextChapterHead
}
let text = ""
if (res != undefined) {
	const path = res.file.path
	const title = res.title
	const decoLink = "[[" + path + "|" + title + "]]"
	text = "Next Article: " + decoLink
} else {
	text = "æ—…é€”çš„ç»ˆç‚¹ï¼"
}
dv.el("p", text, { attr: { align: "right" } })
```